---
title: 让exe程序自动重启第三方工具
type: tags
orderby: random
order: 1
abbrlink: 31986
date: 2023-05-05 00:00:00
---

# 任务计划程序
Windows Task Scheduler（Windows 任务计划程序）：Windows 自带的任务计划程序**可以设置定时执行任务，并且包括重启应用程序的选项**。你可以使用任务计划程序创建一个定时任务，在指定的时间间隔内重启指定的 `.exe` 文件。
## 使用任务计划程序关闭.exe文件
### 实现流程
1.  打开计划任务（Task Scheduler）应用程序。使用快捷键组合 Win + R 打开“运行”对话框，然后输入 "taskschd.msc"，按下回车键打开
2.  在计划任务应用程序中，点击"创建基本任务"（Create Basic Task）来创建一个新任务。
    
3.  给任务起一个名称，例如"Ngrok Restart"，并提供一个可选的描述。
    
4.  在触发器（Trigger）部分，点击"新建"（New）来创建一个新的触发器。
    
5.  在触发器设置中，选择"按计划"（On a schedule），并指定要执行任务的日期和时间。你可以设置重复执行任务的频率和间隔。
    
6.  在操作（Action）部分，选择"启动程序"（Start a program）并提供ngrok.exe的完整路径。
    
7.  点击"完成"（Finish）来创建计划任务。

### 使用任务计划程序实现自动启动程序的坑！！
**直接在操作中填入xbot个微版.exe竟然不能自启动！打开闪一下就会关闭！**
#### 解决办法：
1. 任务计划程序定时执行py文件
在exe的同目录下，写一个run.py

```
import os
path = 'xbot个微版.exe'
os.system(path)
```
在对该程序新建一个定时任务。
![](images/screenshot_1684831672090.png)
![](images/screenshot_1684831690395.png)
![](images/screenshot_1684831738443.png)
![](images/screenshot_1684831727866.png)
![](images/screenshot_1684831716459.png)

然后就可以在触发设置的触发条件后就会自动执行py文件，从而执行exe文件。
**又有一个问题**，那就是一般情况下，早上七点，我的电脑此时是在睡眠状态。此时无法执行计划程序，而是等我什么时间打开了计算机，才会补执行。

而即使前面设置了唤醒计算机，也没法真的唤醒计算机，所以需要解决在睡眠状态下唤醒计算机这个问题。

2.  睡眠状态下唤醒计算机


在系统的睡眠管理中进行设置。
![](images/screenshot_1684831804129.png)
然后，即使在睡眠状态下，电脑会自动唤醒，然后执行7点的py文件，执行特定的exe程序。

## 使用任务计划程序关闭.exe文件
### 实现流程
1.  在任务计划程序中创建一个新任务，按照之前提到的步骤选择 "创建任务"。
    
2.  在触发器设置中，选择适合您需求的触发器类型和时间。
    
3.  在操作设置中，选择 "启动程序"。
    
4.  在启动程序设置中，点击 "浏览"，找到并选择一个**脚本文件（.bat 文件）**（.bat文件的创建看下面）。
5.  点击"完成"（Finish）来创建计划任务。

### .bat文件创建
这个文件里面写的就是你关闭.exe程序的命令
如：
```
taskkill /f /im xbot个微版.exe  
```
#### .bat脚本文件编写过程
1.  新建一个文件，后缀写为 ".txt"，使其成为纯文本文件，写入你需要关闭程序的脚本`taskkill /f /im <要关闭程序名字>  `
    
2.  使用一个文本编辑器（如记事本）打开该文件。
    
3.  在文本编辑器中，选择 "文件" 菜单，然后选择 "另存为"。
    
4.  在 "另存为" 对话框中，将 "编码" 选项更改为 "ANSI" 或 "UTF-8"（如果您确定原始文本文件的编码方式）。
5.  将文件名更改为 ".bat" 的后缀，然后保存文件。

### 使用.bat脚本文件出现的问题
#### 打开一闪而过
cmd打开终端输入终止程序的命令查看是不是.exe文件写错了
![](images/screenshot_1684835297887.png)

查看一闪而过的终端中执行的脚本是否有误
因为你直接在桌面就直接把.txt后缀修改.bat了！！（解决方案看.bat脚本编写过程）
![](images/screenshot_1684835453204.png)
![](images/screenshot_1684835416338.png)


# NSSM
(不是很好用)
### 实现流程
1.  下载 NSSM：首先，你需要从 NSSM 的官方网站（[https://nssm.cc/download）下载适用于你的](https://nssm.cc/download%EF%BC%89%E4%B8%8B%E8%BD%BD%E9%80%82%E7%94%A8%E4%BA%8E%E4%BD%A0%E7%9A%84) Windows 版本的 NSSM 安装文件。
    
2.  安装 NSSM：运行下载的 NSSM 安装文件，按照安装向导的指示完成 NSSM 的安装过程。安装完成后，NSSM 将被添加到系统的 PATH 环境变量中。
    
3.  打开命令提示符：按下 `Win + R` 键，然后输入 `cmd` 并按回车键，这将打开命令提示符窗口。
    
4.  定位到 NSSM 安装目录：在命令提示符中，使用 `cd` 命令切换到 NSSM 的安装目录。默认情况下，NSSM 的安装目录为 `C:\Program Files\nssm`。
    
5.  安装应用程序作为服务：在命令提示符中执行以下命令来安装你的应用程序作为服务：
    
    ~~~
    phpCopy codenssm install <servicename> <pathtoexecutable>
    
    ~~~
    
    其中 `<servicename>` 是你希望为服务指定的名称，`<pathtoexecutable>` 是你的可执行文件的路径。
    
6.  配置服务选项：安装成功后，NSSM 将自动打开编辑器来配置服务选项。你可以设置服务的启动参数、工作目录、环境变量等。编辑完成后，保存并关闭编辑器。
    
7.  启动服务：在命令提示符中执行以下命令来启动服务：
    
    ~~~
    phpCopy codenssm start <servicename>
    
    ~~~
    
    `<servicename>` 是你之前为服务指定的名称。
    

现在，你的应用程序将作为服务在后台运行。你可以使用 NSSM 提供的其他命令来停止、重启和管理服务。例如，使用 `nssm stop <servicename>` 命令来停止服务，使用 `nssm restart <servicename>` 命令来重启服务。

请注意，NSSM 还提供了其他高级功能和选项，你可以参考 NSSM 的文档（[https://nssm.cc/usage）以了解更多详细信息和用法示例。](https://nssm.cc/usage%EF%BC%89%E4%BB%A5%E4%BA%86%E8%A7%A3%E6%9B%B4%E5%A4%9A%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF%E5%92%8C%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B%E3%80%82)